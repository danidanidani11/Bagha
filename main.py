from flask import Flask
import threading
import os

app = Flask(__name__)

@app.route('/')
def home():
    return "ربات روشن است ✅"

def run_flask():
    port = int(os.environ.get("PORT", 5000))
    app.run(host="0.0.0.0", port=port)

threading.Thread(target=run_flask).start()

import telebot, json, os, time, datetime
from telebot import types
# راه‌اندازی وب سرور برای Render‏import telebot
import json
import os
from telebot import types

‏bot = telebot.TeleBot('7459857250:AAHpb_NliuOiM7-cTmFSrospKdoKMnAFiew')
‏admin_id = 5542927340
‏channel = 'bagha_game'
‏tron_address = 'TJ4xrwKJzKjk6FgKfuuqwah3Az5Ur22kJb'

questions = [
    {
        "q": "چشمانت را باز می‌کنی... هواپیما سقوط کرده و در میان درختان انبوه به هوش آمدی. چه کاری اول انجام می‌دهی؟",
        "o": ["الف) بررسی آسیب‌دیدگی خودم", "ب) دویدن برای پیدا کردن کمک"],
        "a": "الف) بررسی آسیب‌دیدگی خودم",
        "d": "باید مطمئن شوی که زنده‌ای و قابلیت حرکت داری."
    },
    {
        "q": "در اطرافت بوی بنزین می‌پیچد. چیزی جرقه نزده. چه می‌کنی؟",
        "o": ["الف) از محل دور می‌شوم", "ب) در جیبم دنبال فندک می‌گردم"],
        "a": "الف) از محل دور می‌شوم",
        "d": "هر لحظه ممکنه انفجار رخ بده. اول ایمنی!"
    },
    {
        "q": "با فاصله کمی، صدای ناله شنیدی. هم‌سفرت زنده مانده. چکار می‌کنی؟",
        "o": ["الف) بهش کمک می‌کنم", "ب) نادیده می‌گیرم و می‌رم دنبال غذا"],
        "a": "الف) بهش کمک می‌کنم",
        "d": "همراه داشتن یک یار، شانس زنده موندن رو دو برابر می‌کنه."
    },
    {
        "q": "آسمون تاریک شده و باید پناهگاه بسازی. کجا رو انتخاب می‌کنی؟",
        "o": ["الف) کنار رودخانه", "ب) بالای درخت", "ج) داخل غار"],
        "a": "ج) داخل غار",
        "d": "غار می‌تونه سرپناه خوبی باشه، البته اگر مطمئن شی که خالیه."
    },
    {
        "q": "در داخل غار چشم‌هات به چشم‌های درخشان حیوانی می‌افته. چی‌کار می‌کنی؟",
        "o": ["الف) فرار می‌کنی", "ب) داد می‌زنی", "ج) بی‌حرکت می‌مونی"],
        "a": "ج) بی‌حرکت می‌مونی",
        "d": "حرکات ناگهانی ممکنه حیوان رو تحریک کنه. سکون گاهی امن‌ترینه."
    },
    {
        "q": "حیوان خارج می‌شه و غار امنه. حالا باید آتش روشن کنی. چه چیزی مناسبه؟",
        "o": ["الف) چوب مرطوب", "ب) برگ خشک", "ج) شاخه ضخیم"],
        "a": "ب) برگ خشک",
        "d": "برگ خشک سریع‌تر آتش می‌گیره. چوب مرطوب اصلاً خوب نیست."
    },
    {
        "q": "برای غذا باید شکار کنی. کدوم ابزار ساده رو می‌سازی؟",
        "o": ["الف) نیزه با چوب", "ب) تله با طناب", "ج) فلاخن سنگی"],
        "a": "الف) نیزه با چوب",
        "d": "در ابتدای بقا، نیزه ساده‌ترین و کاراترین سلاحه."
    },
    {
        "q": "حشره‌ای عجیب روی دستت می‌نشیند. چکار می‌کنی؟",
        "o": ["الف) سریع لهش می‌کنی", "ب) آروم تکونش می‌دی"],
        "a": "ب) آروم تکونش می‌دی",
        "d": "شاید سمی باشه، حرکت سریع تحریکش می‌کنه."
    },
    {
        "q": "در جنگل صدای رعد و برق میاد. بهترین مکان برای پناه چیه؟",
        "o": ["الف) زیر درخت بلند", "ب) داخل دره", "ج) کنار سنگ بزرگ"],
        "a": "ج) کنار سنگ بزرگ",
        "d": "درخت بلند خطرناک‌ترین جا توی رعدوبرقه."
    },
    {
        "q": "شب با صدای عجیبی بیدار می‌شی. هم‌تیمت نیست! چکار می‌کنی؟",
        "o": ["الف) دنبالش می‌گردی", "ب) منتظر می‌مونی", "ج) فریاد می‌زنی"],
        "a": "الف) دنبالش می‌گردی",
        "d": "شاید زخمی شده باشه، منتظر موندن کمکی نمی‌کنه."
    },
    {
        "q": "هم‌تیمت گیر افتاده توی باتلاق. چکار می‌کنی؟",
        "o": ["الف) طناب می‌ندازی", "ب) داخل باتلاق می‌پری"],
        "a": "الف) طناب می‌ندازی",
        "d": "پریدن تو باتلاق فقط باعث می‌شه هر دوتا غرق بشید."
    },
    {
        "q": "برای ادامه مسیر، باید جهت‌یابی کنی. چی استفاده می‌کنی؟",
        "o": ["الف) خزه روی درخت", "ب) صدای حیوانات", "ج) خورشید"],
        "a": "ج) خورشید",
        "d": "خورشید همیشه جهت شرق/غرب رو نشون می‌ده."
    },
    {
        "q": "توی مسیر، رودخونه‌ای می‌بینی. باید عبور کنی. چی‌کار می‌کنی؟",
        "o": ["الف) شنا می‌کنی", "ب) پل با چوب می‌سازی", "ج) مسیر بهتری می‌گردی"],
        "a": "ب) پل با چوب می‌سازی",
        "d": "شنا ممکنه خطرناک باشه، مخصوصاً با جریان تند."
    },
    {
        "q": "مقداری میوه پیدا می‌کنی. از کجا می‌فهمی که سمی نیست؟",
        "o": ["الف) رنگ روشن", "ب) خوردن کم‌کم", "ج) دادن به حیوان"],
        "a": "ب) خوردن کم‌کم",
        "d": "آزمایش مرحله‌ای روش بهتریه تا مستقیم خوردن."
    },
    {
        "q": "نشونه‌هایی از حضور انسان می‌بینی. ردپاها به کجا می‌رن؟",
        "o": ["الف) سمت کوه", "ب) به داخل جنگل تاریک", "ج) کنار دریاچه"],
        "a": "ج) کنار دریاچه",
        "d": "آب همیشه برای کمپ‌ها جذابه."
    },
    {
        "q": "ردپاها ناگهان قطع می‌شن. مشکوک نیست؟ چه می‌کنی؟",
        "o": ["الف) همون‌جا کمپ می‌زنی", "ب) مسیر رو بررسی می‌کنی", "ج) فرار می‌کنی"],
        "a": "ب) مسیر رو بررسی می‌کنی",
        "d": "ردپاها ممکنه مخفی شده باشن یا کسی عمداً پنهانشون کرده."
    },
    {
        "q": "یه نقشه‌ی نیمه‌سوخته پیدا می‌کنی. بخشی ازش هنوز خوناس. چه می‌کنی؟",
        "o": ["الف) حفظش می‌کنی", "ب) می‌سوزونیش", "ج) بی‌تفاوتی"],
        "a": "الف) حفظش می‌کنی",
        "d": "نقشه ممکنه راه فرار یا گنج رو نشون بده."
    },
    {
        "q": "یه صدا از بی‌سیم شنیده می‌شه: «کمک!» آیا پاسخ می‌دی؟",
        "o": ["الف) پاسخ می‌دی", "ب) سکوت می‌کنی"],
        "a": "ب) سکوت می‌کنی",
        "d": "ممکنه تله باشه. در جزیره ناشناس باید محتاط بود."
    },
    {
        "q": "چاله‌ای پر از استخوان حیوانات پیدا می‌کنی. چه می‌کنی؟",
        "o": ["الف) سریع دور می‌شی", "ب) بررسی می‌کنی", "ج) تله می‌سازی اونجا"],
        "a": "ج) تله می‌سازی اونجا",
        "d": "ممکنه حیوانی شبانه اونجا بیاد. تله‌ش کنی."
    },
    {
        "q": "در راه، گیاهی پیدا می‌کنی با بوی عجیب. آیا می‌چینی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "ب) نه",
        "d": "بوی عجیب نشونه‌ی سمی بودن ممکنه باشه."
    },
    {
        "q": "دو نفر غریبه مسلح می‌بینی. تو رو ندیدن. چه می‌کنی؟",
        "o": ["الف) پنهان می‌شی", "ب) جلو می‌ری", "ج) فرار می‌کنی"],
        "a": "الف) پنهان می‌شی",
        "d": "فعلاً ناشناس بودن ایمن‌تره."
    },
    {
        "q": "چاقوی یکی از اون‌ها رو بعداً پیدا می‌کنی. استفاده می‌کنی؟",
        "o": ["الف) آره", "ب) نه"],
        "a": "الف) آره",
        "d": "وسیله بقاست. تا وقتی که ازش خوب استفاده شه، مفیده."
    },
    {
        "q": "یه درخت عجیب با نشونه‌های حک شده پیدا می‌کنی. چه می‌کنی؟",
        "o": ["الف) یادداشت‌برداری", "ب) بی‌تفاوت می‌گذری"],
        "a": "الف) یادداشت‌برداری",
        "d": "ممکنه نشونه مسیر یا خطر باشه."
    },
    {
        "q": "هم‌تیمت تب داره. چکار می‌کنی؟",
        "o": ["الف) گیاه دارویی پیدا می‌کنی", "ب) تنهاش می‌ذاری"],
        "a": "الف) گیاه دارویی پیدا می‌کنی",
        "d": "نجات هم‌تیمی یعنی شانس نجات خودت بیشتره."
    },
    {
        "q": "گروهی صدات می‌کنن که بیان کمک. آیا می‌ری؟",
        "o": ["الف) نه، اعتماد نمی‌کنی", "ب) آره، شاید واقعا نجات باشه"],
        "a": "الف) نه، اعتماد نمی‌کنی",
        "d": "در موقعیت خطرناک، اعتماد کورکورانه می‌تونه کشنده باشه."
    },
    {
        "q": "چند متر جلوتر یه کلبه چوبی متروکه می‌بینی. وارد می‌شی؟",
        "o": ["الف) بله، احتیاط می‌کنی", "ب) نه، شاید تله باشه"],
        "a": "الف) بله، احتیاط می‌کنی",
        "d": "ممکنه سرپناه باشه ولی باید با دقت وارد شد."
    },
    {
        "q": "داخل کلبه یه دفترچه یادداشت پیدا می‌کنی. چه‌کار می‌کنی؟",
        "o": ["الف) می‌خونی", "ب) نادیده می‌گیری"],
        "a": "الف) می‌خونی",
        "d": "ممکنه اطلاعات مهمی از نجات یا خطرات اطراف داشته باشه."
    },
    {
        "q": "دفترچه هشدار داده درباره‌ی «منطقه قرمز». چه‌کار می‌کنی؟",
        "o": ["الف) نزدیک نمی‌شی", "ب) کنجکاو می‌شی و میری"],
        "a": "الف) نزدیک نمی‌شی",
        "d": "هشدارها رو نباید دست‌کم گرفت."
    },
    {
        "q": "نقشه مسیر نجات در دفترچه هست اما ناقصه. چه‌کار می‌کنی؟",
        "o": ["الف) همون قسمت‌ها رو دنبال می‌کنی", "ب) بی‌خیال نقشه می‌شی"],
        "a": "الف) همون قسمت‌ها رو دنبال می‌کنی",
        "d": "حتی نقشه ناقص می‌تونه مفید باشه."
    },
    {
        "q": "وسط راه رد خون می‌بینی. دنبال می‌کنی؟",
        "o": ["الف) آره", "ب) نه"],
        "a": "ب) نه",
        "d": "ممکنه به چیزی خطرناک ختم بشه."
    },
    {
        "q": "آسمون پر از دود شده. بوی سوختگی میاد. چی‌کار می‌کنی؟",
        "o": ["الف) به سمتش میری", "ب) دور می‌شی"],
        "a": "ب) دور می‌شی",
        "d": "ممکنه آتش‌سوزی گسترده باشه."
    },
    {
        "q": "درختی بزرگ با طناب قدیمی می‌بینی. آیا استفاده می‌کنی؟",
        "o": ["الف) بله", "ب) نه، پوسیده‌ست"],
        "a": "ب) نه، پوسیده‌ست",
        "d": "طناب‌های قدیمی ممکنه پاره بشن و خطرناک باشن."
    },
    {
        "q": "روی زمین فلز زنگ‌زده‌ای شبیه جعبه است. بازش می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "الف) بله",
        "d": "ممکنه وسایل نجات یا سرنخ باشه."
    },
    {
        "q": "داخل جعبه قطب‌نما و یک کد رمزدار پیدا می‌کنی. باهاش چکار می‌کنی؟",
        "o": ["الف) نگه می‌داری", "ب) می‌ندازی دور"],
        "a": "الف) نگه می‌داری",
        "d": "قطب‌نما همیشه مفیده و کد ممکنه راه‌گشای یه قفل باشه."
    },
    {
        "q": "حیوانی زخمی می‌بینی که صدا نمی‌ده. چه‌کار می‌کنی؟",
        "o": ["الف) کمک می‌کنی", "ب) نادیده می‌گیری", "ج) شکارش می‌کنی"],
        "a": "ج) شکارش می‌کنی",
        "d": "در موقعیت بقا، منابع غذایی اولویته."
    },
    {
        "q": "به منطقه‌ای پر از مه می‌رسی. ادامه می‌دی؟",
        "o": ["الف) آره", "ب) نه"],
        "a": "ب) نه",
        "d": "مه دیدت رو محدود می‌کنه. خطرناک می‌تونه باشه."
    },
    {
        "q": "یه پرچم قدیمی و خاکی پیدا می‌کنی. نشونه‌ی چیه؟",
        "o": ["الف) گروه قبلی نجات", "ب) تله", "ج) بی‌معنیه"],
        "a": "الف) گروه قبلی نجات",
        "d": "ممکنه محل نجات قبلی بوده باشه. سرنخ مهمیه."
    },
    {
        "q": "توی مسیر، یه تکه فلز براق زیر خاک می‌بینی. بیرونش میاری؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "الف) بله",
        "d": "ممکنه ابزار یا اسلحه باشه."
    },
    {
        "q": "درختانی می‌بینی که پوستشون کنده شده و علامت دارن. چه‌کار می‌کنی؟",
        "o": ["الف) علامت‌ها رو دنبال می‌کنی", "ب) رد می‌شی"],
        "a": "الف) علامت‌ها رو دنبال می‌کنی",
        "d": "ممکنه نشونه‌ی مسیر درست باشه."
    },
    {
        "q": "بخار از یک صخره بیرون می‌زنه. آیا بررسی می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "ب) نه",
        "d": "ممکنه خروجی گازهای سمی یا حرارتی باشه."
    },
    {
        "q": "صدای بچه‌ای از داخل جنگل میاد. واکنشت چیه؟",
        "o": ["الف) میری کمک", "ب) پنهان می‌شی", "ج) منتظر می‌مونی"],
        "a": "ب) پنهان می‌شی",
        "d": "ممکنه تله باشه. احتیاط کن."
    },
    {
        "q": "یه تکه فلز با حروف حک‌شده از دفترچه پیدا می‌کنی. چکار می‌کنی؟",
        "o": ["الف) رمز رو تطبیق می‌دی", "ب) بی‌تفاوت می‌گذری"],
        "a": "الف) رمز رو تطبیق می‌دی",
        "d": "ممکنه بخشی از قفل مسیر نجات باشه."
    },
    {
        "q": "شب پرستاره‌ست، اما صدای پای قدم‌هایی می‌شنوی. چی‌کار می‌کنی؟",
        "o": ["الف) در تاریکی مخفی می‌شی", "ب) نور آتش رو خاموش می‌کنی", "ج) سر جای خودت می‌مونی"],
        "a": "ب) نور آتش رو خاموش می‌کنی",
        "d": "آتش تو رو لو می‌ده."
    },
    {
        "q": "تکه چوبی به شکل فلش روی زمین می‌بینی. چه‌کار می‌کنی؟",
        "o": ["الف) دنبال فلش می‌ری", "ب) جهت مخالفش میری"],
        "a": "ب) جهت مخالفش میری",
        "d": "ممکنه دیگران برای گمراهی گذاشته باشن."
    },
    {
        "q": "در جنگل، صدای ضبط شده‌ای از بلندگو شنیده می‌شه: «زنده‌ای؟» واکنش؟",
        "o": ["الف) داد می‌زنی بله", "ب) پنهان می‌شی"],
        "a": "ب) پنهان می‌شی",
        "d": "ممکنه کسی دنبالت باشه. امنیتت رو حفظ کن."
    },
    {
        "q": "روی تنه درخت عدد «7» کنده شده. معنی خاصی می‌ده؟",
        "o": ["الف) مرحله ۷ نقشه", "ب) شمارش قربانی", "ج) روز ۷ حضور"],
        "a": "ج) روز ۷ حضور",
        "d": "ممکنه قبلاً کسی روزشماری کرده."
    },
    {
        "q": "به صدای تیراندازی از دور می‌رسی. چکار می‌کنی؟",
        "o": ["الف) پنهان می‌شی", "ب) به سمتش میری", "ج) مسیرت رو عوض می‌کنی"],
        "a": "ج) مسیرت رو عوض می‌کنی",
        "d": "درگیری مسلحانه تهدید بزرگیه."
    },
    {
        "q": "تخته‌سنگی پیدا می‌کنی با نقشه‌ای روی اون. همراهت چیه؟",
        "o": ["الف) دفترچه‌ات", "ب) کد قبلی", "ج) قطب‌نما"],
        "a": "ب) کد قبلی",
        "d": "کد می‌تونه نقشه روی سنگ رو باز کنه."
    },
    {
        "q": "نوشته‌ای روی سنگ: «فقط شجاعان می‌گذرند». عبور می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "الف) بله",
        "d": "گاهی ریسک لازمه برای نجات."
    },
    {
        "q": "بعد از عبور، یک چاه با نردبان می‌بینی. پایین میری؟",
        "o": ["الف) آره", "ب) نه"],
        "a": "آره",
        "d": "ممکنه راهی باشه به چیزی پنهان شده یا زیرزمینی."
    },
    {
        "q": "داخل چاه، ردپای تازه می‌بینی. چی‌کار می‌کنی؟",
        "o": ["الف) دنبال ردپا میری", "ب) عقب‌نشینی می‌کنی"],
        "a": "الف) دنبال ردپا میری",
        "d": "ممکنه کسی اون پایین زنده باشه یا راهی برای خروج بدونه."
    },
    {
        "q": "ردپاها به دری فلزی ختم می‌شن. در رو باز می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "تنها راه ادامه‌ی مسیر ممکنه همین باشه."
    },
    {
        "q": "پشت در یک پناهگاه قدیمی زیرزمینیه. وارد می‌شی؟",
        "o": ["الف) آره", "ب) نه"],
        "a": "آره",
        "d": "ممکنه منابع یا اطلاعات نجات اونجا باشه."
    },
    {
        "q": "داخل پناهگاه چند بطری آب هست. استفاده می‌کنی؟",
        "o": ["الف) بله", "ب) نه، ممکنه آلوده باشه"],
        "a": "ب) نه، ممکنه آلوده باشه",
        "d": "آب ناشناس می‌تونه خطرناک باشه."
    },
    {
        "q": "یه نوار صوتی با تاریخ قدیمی پیدا می‌کنی. گوش می‌دی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "ممکنه اطلاعات کلیدی از علت فاجعه بده."
    },
    {
        "q": "نوار می‌گه: «راه خروج در نقطه‌ی صفر است». چه می‌کنی؟",
        "o": ["الف) دنبال نقطه صفر می‌گردی", "ب) بی‌خیالش می‌شی"],
        "a": "الف) دنبال نقطه صفر می‌گردی",
        "d": "ممکنه کلید نجات اونجا باشه."
    },
    {
        "q": "در نقشه پناهگاه، علامت '0X' روی یکی از نقاطه. به اون سمت میری؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "احتمالاً منظور از نقطه صفر همون باشه."
    },
    {
        "q": "در راه نقطه صفر، درِ بسته‌ای می‌بینی با جای کارت. چکار می‌کنی؟",
        "o": ["الف) دنبال کارت می‌گردی", "ب) درو می‌شکنی"],
        "a": "الف) دنبال کارت می‌گردی",
        "d": "شکستن در ممکنه صدای خطرناکی ایجاد کنه."
    },
    {
        "q": "کارت عبور داخل جسد قدیمیه. آیا برمی‌داری؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "در شرایط بقا، گاهی باید از دل ترس گذشت."
    },
    {
        "q": "در باز می‌شه. فضای تاریک و سرد. چراغ قوه همراهته. استفاده می‌کنی؟",
        "o": ["الف) بله", "ب) نه، باتری ذخیره می‌کنی"],
        "a": "بله",
        "d": "دیدن اطراف از همه‌چی مهم‌تره الان."
    },
    {
        "q": "یک لپ‌تاپ خاموش با کابل جدا پیدا می‌کنی. چی‌کار می‌کنی؟",
        "o": ["الف) دنبال منبع برق می‌گردی", "ب) بی‌خیالش می‌شی"],
        "a": "الف) دنبال منبع برق می‌گردی",
        "d": "ممکنه فایل‌های نجات یا اطلاعات رمز شده روش باشه."
    },
    {
        "q": "منبع برق فعال پیدا کردی، لپ‌تاپ روشن شد. رمز ورود می‌خواد. چکار می‌کنی؟",
        "o": ["الف) رمز 'ZERO' رو امتحان می‌کنی", "ب) بی‌خیال می‌شی"],
        "a": "الف) رمز 'ZERO' رو امتحان می‌کنی",
        "d": "نوار صوتی به نقطه صفر اشاره کرده بود."
    },
    {
        "q": "داخل لپ‌تاپ ویدئویی نشون می‌ده خروجی در «برج متروک شمالی»ه. کجا میری؟",
        "o": ["الف) سمت برج", "ب) بررسی بیشتر در پناهگاه"],
        "a": "الف) سمت برج",
        "d": "حالا وقت حرکته به سمت نجات."
    },
    {
        "q": "در راه برج، پل شکسته‌ای سر راهه. عبور می‌کنی؟",
        "o": ["الف) آهسته عبور می‌کنی", "ب) مسیر جایگزین می‌گردی"],
        "a": "ب) مسیر جایگزین می‌گردی",
        "d": "پل ممکنه فرو بریزه. احتیاط کن."
    },
    {
        "q": "به تقاطع می‌رسی. یکی از تابلوها رو کسی برعکس کرده. چکار می‌کنی؟",
        "o": ["الف) طبق نقشه میری", "ب) تابلوی تغییر یافته رو دنبال می‌کنی"],
        "a": "الف) طبق نقشه میری",
        "d": "تابلوها ممکنه عمداً گمراه‌کننده باشن."
    },
    {
        "q": "یک حیوان گرسنه مسیر رو بسته. چی‌کار می‌کنی؟",
        "o": ["الف) طعمه پرت می‌کنی", "ب) مخفی می‌شی", "ج) فرار می‌کنی"],
        "a": "الف) طعمه پرت می‌کنی",
        "d": "حواس حیوان رو پرت کن تا بتونی عبور کنی."
    },
    {
        "q": "نزدیک برج یه گروه سایه‌وار می‌بینی. چکار می‌کنی؟",
        "o": ["الف) نزدیک می‌شی", "ب) پنهان می‌شی", "ج) عقب‌نشینی می‌کنی"],
        "a": "ب) پنهان می‌شی",
        "d": "اول باید بفهمی کی هستن."
    },
    {
        "q": "یکی از اون‌ها تنها شد و رفت سمت جنگل. تعقیبش می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "ممکنه اطلاعاتی درباره گروه داشته باشه."
    },
    {
        "q": "اون فرد بی‌سیم همراهشه. چی‌کار می‌کنی؟",
        "o": ["الف) برمی‌داری", "ب) فقط تعقیبش می‌کنی"],
        "a": "الف) برمی‌داری",
        "d": "ممکنه ارتباط با دنیای بیرون باشه."
    },
    {
        "q": "از بی‌سیم صدای «برنامه حذف فعال شد» می‌شنوی. چکار می‌کنی؟",
        "o": ["الف) خاموش می‌کنی", "ب) به شنیدن ادامه می‌دی"],
        "a": "ب) به شنیدن ادامه می‌دی",
        "d": "باید بفهمی منظور از حذف چیه."
    },
    {
        "q": "صدا می‌گه: «هرکسی برج رو ترک کنه، هدف خواهد بود». برنامه‌ات چیه؟",
        "o": ["الف) سریع وارد برج می‌شی", "ب) صبر می‌کنی", "ج) راه خروج دیگه پیدا می‌کنی"],
        "a": "ج) راه خروج دیگه پیدا می‌کنی",
        "d": "ممکنه برج تله باشه. عاقلانه‌ترین کار، پیدا کردن مسیر دیگه‌ست."
    },
    {
        "q": "نقشه‌ای جدید روی بی‌سیم دریافت می‌کنی. اون رو دنبال می‌کنی؟",
        "o": ["الف) بله", "ب) نه، ممکنه جعلی باشه"],
        "a": "بله",
        "d": "اگر واقعی باشه، آخرین شانس نجاته."
    },
    {
        "q": "نقشه به در ورودی تونلی مهر و موم‌شده ختم می‌شه. بازش می‌کنی؟",
        "o": ["الف) با ابزار باز می‌کنی", "ب) صبر می‌کنی تا شب"],
        "a": "الف) با ابزار باز می‌کنی",
        "d": "زمان کمه، باید سریع عمل کنی."
    },
    {
        "q": "وارد تونل می‌شی و علامت‌های نورانی رو می‌بینی. دنبال می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "ممکنه راهی به نقطه امن باشه."
    },
    {
        "q": "رد نورها به یه در فلزی عجیب ختم می‌شن. روی در نوشته: 'بازگشت فقط با رمز'. چکار می‌کنی؟",
        "o": ["الف) رمز 'XRETURN' رو امتحان می‌کنی", "ب) برمی‌گردی دنبال سرنخ"],
        "a": "الف) رمز 'XRETURN' رو امتحان می‌کنی",
        "d": "روی در نوشته 'بازگشت' و رمز احتمالاً مرتبط با واژه‌ست."
    },
    {
        "q": "در باز میشه و صدای آژیر ضعیفی میاد. چی‌کار می‌کنی؟",
        "o": ["الف) سریع وارد می‌شی", "ب) بیرون صبر می‌کنی"],
        "a": "ب) بیرون صبر می‌کنی",
        "d": "ممکنه تله یا سیستم دفاعی فعال شده باشه."
    },
    {
        "q": "بعد از مدتی صدا قطع میشه. وارد می‌شی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "الف) بله",
        "d": "الان وقتشه حرکت کنی."
    },
    {
        "q": "فضای داخلی شبیه آزمایشگاه سریه. کنسولی فعال می‌بینی. بررسی می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "ممکنه راه کنترل سیستم یا باز کردن در خروجی باشه."
    },
    {
        "q": "کنسول می‌گه: 'آیا می‌خواهید فرآیند بازیابی را آغاز کنید؟'. انتخابت چیه؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "الف) بله",
        "d": "این می‌تونه شروع پایان این کابوس باشه."
    },
    {
        "q": "بازیابی شروع میشه. برق قطع می‌شه. چکار می‌کنی؟",
        "o": ["الف) دنبال ژنراتور اضطراری می‌گردی", "ب) منتظر می‌مونی"],
        "a": "الف) دنبال ژنراتور اضطراری می‌گردی",
        "d": "فرصت‌ها کوتاهن، باید سریع برق رو برگردونی."
    },
    {
        "q": "ژنراتور رو پیدا می‌کنی ولی سوخت نداره. چکار می‌کنی؟",
        "o": ["الف) به اتاق تجهیزات میری", "ب) ولش می‌کنی"],
        "a": "الف) به اتاق تجهیزات میری",
        "d": "شاید اونجا قوطی سوخت پیدا بشه."
    },
    {
        "q": "داخل اتاق تجهیزات یه قوطی سوخت و یه نقشه دیگه هست. اول کدومو برمی‌داری؟",
        "o": ["الف) سوخت", "ب) نقشه"],
        "a": "الف) سوخت",
        "d": "بدون برق، اطلاعات مهم‌ هم بی‌استفاده‌ن."
    },
    {
        "q": "برق برمی‌گرده. بازیابی تا ۹۰٪ میره ولی گیر می‌کنه. چکار می‌کنی؟",
        "o": ["الف) کنسول رو ریست می‌کنی", "ب) صبر می‌کنی"],
        "a": "الف) کنسول رو ریست می‌کنی",
        "d": "گاهی ریست باعث آزاد شدن فرآیند می‌شه."
    },
    {
        "q": "سیستم پیامی نمایش می‌ده: 'ورود کاربر سطح A'. ادامه می‌دی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "ممکنه به اطلاعات سطح بالا دسترسی پیدا کنی."
    },
    {
        "q": "اطلاعات فاش می‌کنن این آزمایشگاه دلیل آغاز فاجعه بوده. چه می‌کنی؟",
        "o": ["الف) اطلاعات رو ذخیره می‌کنی", "ب) حذفشون می‌کنی"],
        "a": "الف) اطلاعات رو ذخیره می‌کنی",
        "d": "ممکنه این اطلاعات برای بازماندگان آینده مفید باشن."
    },
    {
        "q": "سیستم در مخفی خروج اضطراری رو نشون می‌ده. فعالش می‌کنی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "این ممکنه تنها راه فرار از این مکان باشه."
    },
    {
        "q": "در باز می‌شه ولی صدای کسی از پشت میاد: 'صبر کن!'. چکار می‌کنی؟",
        "o": ["الف) برمی‌گردی", "ب) فرار می‌کنی"],
        "a": "الف) برمی‌گردی",
        "d": "ممکنه اون فرد هم بازمانده باشه یا چیزی برای گفتن داشته باشه."
    },
    {
        "q": "فرد یه محقق زخمیه. کمک می‌کنی یا میری؟",
        "o": ["الف) کمک می‌کنی", "ب) میری"],
        "a": "الف) کمک می‌کنی",
        "d": "تو هم ممکنه یه روز نیازمند کمک باشی."
    },
    {
        "q": "محقق می‌گه: 'فقط با من می‌تونی از در اصلی خارج شی'. باهاش میری؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "ممکنه کد یا کارت دسترسی لازم داشته باشه."
    },
    {
        "q": "در خروج نهایی به چهره‌نگاری نیاز داره. محقق می‌گه باید اعتماد کنی. اجازه می‌دی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "الان وقت خطرپذیریه."
    },
    {
        "q": "در باز می‌شه و تونل نجاتی آشکار می‌شه. وارد می‌شی؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "این راه ممکنه پایان رنجت باشه."
    },
    {
        "q": "وسط تونل، در لرزش شدید احساس می‌کنی. جلو میری یا برمی‌گردی؟",
        "o": ["الف) جلو میری", "ب) برمی‌گردی"],
        "a": "الف) جلو میری",
        "d": "الان دیگه راه برگشتی نیست."
    },
    {
        "q": "در خروجی، نور طبیعی می‌بینی ولی صدای شلیک هم میاد. چکار می‌کنی؟",
        "o": ["الف) بیرون میری", "ب) پنهان می‌شی"],
        "a": "ب) پنهان می‌شی",
        "d": "باید موقعیت رو بررسی کنی، شاید دشمن بیرونه."
    },
    {
        "q": "منتظر می‌مونی تا سکوت بشه. حالا بیرون میری؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "بله",
        "d": "الان لحظه رهایی رسیده."
    },
    {
        "q": "وقتی بیرون می‌ری، یه پهپاد کمکی پیدات می‌کنه. علامت می‌دی؟",
        "o": ["الف) بله", "ب) مخفی می‌شی"],
        "a": "بله",
        "d": "ممکنه بالاخره نجات یافته باشی!"
    },
    {
        "q": "پهپاد پیامی پخش می‌کنه: 'شما بازمانده ثبت‌شده‌اید'. واکنش نشون می‌دی؟",
        "o": ["الف) فریاد می‌زنی", "ب) ساکت می‌مونی"],
        "a": "الف) فریاد می‌زنی",
        "d": "تمام سختی‌ها ارزششو داشت. تو نجات پیدا کردی!"
    },
    {
        "q": "مامور نجات می‌پرسه: 'آیا چیزی برای گزارش داری؟'. چی‌کار می‌کنی؟",
        "o": ["الف) کل ماجرا رو تعریف می‌کنی", "ب) ساکت می‌مونی"],
        "a": "الف) کل ماجرا رو تعریف می‌کنی",
        "d": "دانشت ممکنه جلوی فجایع بعدی رو بگیره."
    },
    {
        "q": "از تو می‌پرسن: «حاضری دوباره برای نجات بقیه برگردی؟». پاسخ تو؟",
        "o": ["الف) بله", "ب) نه"],
        "a": "الف) بله",
        "d": "قهرمانان واقعی همیشه باز می‌گردند."
    }
]

def load():
    if os.path.exists('users.json'):
        with open('users.json', 'r') as f:
            return json.load(f)
    return {}

def save(data):
    with open('users.json', 'w') as f:
        json.dump(data, f, indent=4)

def get_top_users():
    data = load()
    users = [user for user in data.values() if user.get('score', 0) > 0]
    return sorted(users, key=lambda x: x['score'], reverse=True)[:10]

@bot.message_handler(commands=['start'])
def start(m):
    data = load()
    uid = str(m.from_user.id)
    if uid not in data:
        data[uid] = {
            "name": "",
            "coins": 0,
            "score": 0,
            "life": 3,
            "step": 0,
            "last_daily": "",
            "waiting_receipt": False,
            "in_game": False
        }
        save(data)
    check_sub(m)

def check_sub(msg):
    try:
        status = bot.get_chat_member(f"@{channel}", msg.from_user.id).status
    except Exception:
        status = "left"
    
    if status in ["member", "administrator", "creator"]:
        ask_name(msg)
    else:
        link = f"https://t.me/{channel}"
        btn = types.InlineKeyboardMarkup()
        btn.add(types.InlineKeyboardButton("عضویت در کانال 📢", url=link))
        btn.add(types.InlineKeyboardButton("عضو شدم ✅", callback_data="check"))
        bot.send_message(msg.chat.id, "برای ادامه، لطفا عضو کانال شو:", reply_markup=btn)

@bot.callback_query_handler(func=lambda c: True)
def callback(c):
    uid = str(c.from_user.id)
    data = load()
    
    if c.data == "check":
        try:
            status = bot.get_chat_member(f"@{channel}", c.from_user.id).status
        except Exception:
            status = "left"
        
        if status in ["member", "administrator", "creator"]:
            ask_name(c.message)
        else:
            bot.answer_callback_query(c.id, "⛔ هنوز عضو کانال نشدی!", show_alert=True)
    
    elif c.data == "buy_life":
        if data[uid]["coins"] >= 100:
            data[uid]["coins"] -= 100
            data[uid]["life"] += 1
            save(data)
            bot.edit_message_text("✅ جان خریداری شد!", c.message.chat.id, c.message.message_id)
        else:
            bot.answer_callback_query(c.id, "سکه کافی نداری!", show_alert=True)
    
    elif c.data.startswith('admin_'):
        if str(c.from_user.id) != str(admin_id):
            bot.answer_callback_query(c.id, "شما ادمین نیستید!", show_alert=True)
            return
            
        action, user_id = c.data.split('_')[1], c.data.split('_')[2]
        
        if action == 'approve':
            data[user_id]['coins'] += 100
            save(data)
            bot.send_message(user_id, "✅ پرداخت شما تایید شد! 100 سکه به حساب شما اضافه شد.")
            bot.edit_message_reply_markup(c.message.chat.id, c.message.message_id, reply_markup=None)
            bot.answer_callback_query(c.id, "تایید شد!")
        elif action == 'reject':
            bot.send_message(user_id, "❌ پرداخت شما رد شد! در صورت مشکل با پشتیبانی تماس بگیرید.")
            bot.edit_message_reply_markup(c.message.chat.id, c.message.message_id, reply_markup=None)
            bot.answer_callback_query(c.id, "رد شد!")

@bot.message_handler(func=lambda m: m.text == "🏆 برترین‌ها")
def show_top(m):
    top_users = get_top_users()
    if not top_users:
        bot.send_message(m.chat.id, "هنوز هیچ بازیکنی امتیازی کسب نکرده است!")
        return
    
    text = "🏆 10 بازیکن برتر:\n\n"
    for i, user in enumerate(top_users, 1):
        text += f"{i}. {user['name']} - امتیاز: {user['score']}\n"
    
    bot.send_message(m.chat.id, text)

@bot.message_handler(func=lambda m: m.text == "🛒 فروشگاه")
def shop(m):
    data = load()
    uid = str(m.from_user.id)
    data[uid]["in_game"] = False
    save(data)
    
    text = """🛍 فروشگاه:
    
💳 برای خرید سکه:
1. مبلغ 4 TRX به آدرس زیر واریز کنید:
`TJ4xrwKJzKjk6FgKfuuqwah3Az5Ur22kJb`
2. سپس رسید پرداخت را برای ما ارسال کنید
3. پس از تایید، 100 سکه دریافت می‌کنید"""
    
    markup = types.InlineKeyboardMarkup()
    markup.add(types.InlineKeyboardButton("🩸 خرید جان (۱۰۰ سکه)", callback_data="buy_life"))
    markup.add(types.InlineKeyboardButton("📤 ارسال رسید پرداخت", callback_data="send_receipt"))
    
    bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode="Markdown")

@bot.callback_query_handler(func=lambda c: c.data == "send_receipt")
def ask_for_receipt(c):
    data = load()
    uid = str(c.from_user.id)
    data[uid]["waiting_receipt"] = True
    save(data)
    
    bot.send_message(c.message.chat.id, "لطفاً تصویر یا متن رسید پرداخت خود را ارسال کنید:")
    bot.answer_callback_query(c.id, "آماده دریافت رسید شما هستیم")

@bot.message_handler(content_types=["text", "photo"])
def handle_receipt(m):
    data = load()
    uid = str(m.from_user.id)
    
    if uid not in data or not data[uid].get("waiting_receipt"):
        return handle_text(m)
    
    data[uid]["waiting_receipt"] = False
    save(data)
    
    # ارسال به ادمین
    admin_text = f"📥 رسید جدید از:\nنام: {data[uid]['name']}\nآیدی: {uid}\n"
    
    if m.content_type == "text":
        admin_text += f"متن رسید: {m.text}"
        bot.send_message(admin_id, admin_text, reply_markup=create_admin_markup(uid))
    elif m.content_type == "photo":
        admin_text += f"متن همراه: {m.caption}" if m.caption else "بدون توضیحات"
        bot.send_photo(admin_id, m.photo[-1].file_id, caption=admin_text, reply_markup=create_admin_markup(uid))
    
    bot.send_message(m.chat.id, "✅ رسید شما دریافت شد. لطفاً منتظر تایید ادمین بمانید.")

def create_admin_markup(user_id):
    markup = types.InlineKeyboardMarkup()
    markup.row(
        types.InlineKeyboardButton("✅ تایید پرداخت", callback_data=f"admin_approve_{user_id}"),
        types.InlineKeyboardButton("❌ رد پرداخت", callback_data=f"admin_reject_{user_id}")
    )
    return markup

# ... (بقیه توابع مانند قبل شامل ask_name, save_name, main_menu, send_question, handle_text)

if __name__ == '__main__':
    print("Bot is running...")
    bot.infinity_polling()
