import telebot, json, os, datetime, random
from flask import Flask, request
from telebot import types
from threading import Thread

API_TOKEN = '7459857250:AAHpb_NliuOiM7-cTmFSrospKdoKMnAFiew'
bot.set_my_commands([
    telebot.types.BotCommand("start", "ุดุฑูุน ุฑุจุงุช"),
])
CHANNEL_USERNAME = "@bagha_game"
ADMIN_ID = 5542927340
TRON_ADDRESS = "TJ4xrwKJzKjk6FgKfuuqwah3Az5Ur22kJb"

bot = telebot.TeleBot(API_TOKEN)
app = Flask(__name__)

DATA_FILE = "users.json"
QUESTIONS_FILE = "questions.json"

if not os.path.exists(DATA_FILE):
    with open(DATA_FILE, "w") as f:
        json.dump({}, f)

# โ ุจุงุฑฺฏุฐุงุฑ ุณูุงูุงุช ุงุฒ ูุงู ุง ุณุงุฎุช ุงููู
if not os.path.exists(QUESTIONS_FILE):
    sample_questions = [

{
"question": "โ๏ธ [ูุฑุญูู 1] ููุงูพูุง ุณููุท ฺฉุฑุฏู ู ุดูุง ุฏุฑ ุฌูฺฏู ุชุงุฑฺฉ ูุณุชุฏ. ุงููู ูุงฺฉูุด ุดูุง ฺุณุชุ",
"options": ["๐ ูุฑุงุฑ ูโฺฉูู", "๐งญ ููุดู ูโฺฉุดู", "๐ฅ ุขุชุด ุฑูุดู ูโฺฉูู", "๐ฑ ุชุณูู ูโุดูู"],
"answer": 2,
"explanations": {
0: "ูุฑุงุฑ ุจุฏูู ูุฏู ููฺฉู ุงุณุช ุจุงุนุซ ฺฏูโุดุฏฺฏ ุจุดุชุฑ ุดูุฏ.",
1: "ููุดู ฺฉุดุฏู ุจุฏูู ุฏุฏ ฺฉุงู ุจโูุงุฏู ุงุณุช.",
2: "โ ุฑูุดู ฺฉุฑุฏู ุขุชุด ุจุงุนุซ ุฏุฏู ุดุฏู ุชูุณุท ุชู ูุฌุงุช ูโุดูุฏ.",
3: "ุชุณูู ุดุฏู ุจู ูุนูุง ูพุงุงู ุชูุงุด ุจุฑุง ุจูุง ุงุณุช."
}},

{
"question": "๐ฒ [ูุฑุญูู 2] ุตุฏุง ุดฺฉุณุช ุดุงุฎูโุง ุฏุฑ ูพุดุช ุณุฑุช ูโุดูู. ฺู ูโฺฉูุ",
"options": ["๐ ุจุฑูโฺฏุฑุฏู", "๐ ุณุฑุน ุฏูุฑ ูโุดูู", "๐ ูพููุงู ูโุดูู", "๐ฃ ูุฑุงุฏ ูโุฒูู"],
"answer": 2,
"explanations": {
0: "ุจุฑฺฏุดุชู ูโุชูุงูุฏ ุจุงุนุซ ุฑูุงุฑู ูุงฺฏูุงู ุจุง ุฎุทุฑ ุดูุฏ.",
1: "ูุฑุงุฑ ุตุฏุง ุจุดุชุฑ ุชููุฏ ูโฺฉูุฏ.",
2: "โ ูพููุงู ุดุฏู ุฏุฑ ุณฺฉูุช ุจูุชุฑู ุงูุชุฎุงุจ ุจุฑุง ุญูุธ ุฌุงู ุงุณุช.",
3: "ูุฑุงุฏ ุฒุฏู ุฎุทุฑ ุฑุง ุจู ุณูุช ุดูุง ูโฺฉุดุงูุฏ."
}},

{
"question": "๐ [ูุฑุญูู 3] ุจู ฺฉ ฺฉูููโูพุดุช ูโุฑุณ. ููุท ฺฉ ุขุชู ุฌุง ุฏุงุฑุฏ. ฺฉุฏุงู ุฑุง ุจุฑูโุฏุงุฑุ",
"options": ["๐ง ุจุทุฑ ุขุจ", "๐ช ฺุงูู", "๐งญ ูุทุจโููุง", "๐ ฺฉูุณุฑู ุบุฐุง"],
"answer": 0,
"explanations": {
0: "โ ุขุจ ุจุฑุง ุฒูุฏู ูุงูุฏู ุงุฒ ููู ุญุงุชโุชุฑ ุงุณุช.",
1: "ฺุงูู ููู ุงุณุชุ ุงูุง ุจุฏูู ุขุจ ุฒูุฏู ููโูุงู.",
2: "ูุทุจโููุง ุจุฏูู ูุณุฑ ูุดุฎุต ฺฉูฺฉ ุฒุงุฏ ููโฺฉูุฏ.",
3: "ุบุฐุง ููู ุงุณุชุ ุงูุง ุจุฏู ุจุฏูู ุขุจ ุณุฑุนโุชุฑ ุชุญูู ูโุฑูุฏ."
}},

{
"question": "๐ [ูุฑุญูู 4] ุดุจ ุงุณุช ู ุจุงุฏ ูพูุงูฺฏุงู ูพุฏุง ฺฉู. ฺฉุฌุง ูโุฎูุงุจุ",
"options": ["๐ณ ุฒุฑ ุฏุฑุฎุช ุจุฒุฑฺฏ", "๐ ฺฉูุงุฑ ุชุฎุชูโุณูฺฏ", "๐ง ฺฉูุงุฑ ููุฑ", "๐ ุฏุฑ ูุถุง ุจุงุฒ"],
"answer": 1,
"explanations": {
0: "ุฒุฑ ุฏุฑุฎุช ุฎุทุฑ ุฑุฒุด ุดุงุฎู ู ุญูุงูุงุช ุฏุงุฑุฏ.",
1: "โ ฺฉูุงุฑ ุชุฎุชูโุณูฺฏ ุจุงุฏ ุฑุง ูโฺฏุฑุฏ ู ูุญุงูุธ ูุณุจ ุงุณุช.",
2: "ฺฉูุงุฑ ููุฑ ุดุจโููฺฏุงู ุฎุทุฑูุงฺฉ ุงุณุช (ูุงุฑุ ุณุฑูุง).",
3: "ุฎูุงุจุฏู ุฏุฑ ูุถุง ุจุงุฒ ุฎุทุฑ ุญููู ุญูุงูุงุช ุฑุง ุฏุงุฑุฏ."
}},

{
"question": "๐ฅ [ูุฑุญูู 5] ฺุทูุฑ ุขุชุด ุฏุฑุณุช ูโฺฉูุ",
"options": ["๐ช ุจุง ุฒุฏู ุณูฺฏ ุจู ฺุงูู", "๐ฑ ุจุง ููุฒ ฺฏูุด", "๐งป ุจุง ูุงูุด ฺูุจโูุง", "๐จ ุงุตูุงู ุขุชุด ููโุฒูู"],
"answer": 2,
"explanations": {
0: "ุณูฺฏ ุจู ฺุงูู ุฌุฑูู ูุฏุงุฑุฏ.",
1: "ููุฒ ฺฏูุด ฺฉุงู ูุณุชุ ูุฎุตูุตุงู ุฏุฑ ุดุจ.",
2: "โ ูุงูุด ฺูุจโูุง ุฑูุด ุณูุช ูู ูุคุซุฑ ุจุฑุง ุงุฌุงุฏ ุขุชุด ุงุณุช.",
3: "ูุจูุฏ ุขุชุด ูุณุงู ุงุณุช ุจุง ุณุฑูุง ู ุฎุทุฑ ุฏุฑ ุดุจ."
}},

{
"question": "๐ก [ูุฑุญูู 6] ุตุฏุง ุณฺฏูุงู ุฑุงุฏู ูโุดูู. ฺู ูโฺฉูุ",
"options": ["๐ ุฏูุจุงู ุตุฏุง ูโุฑู", "๐ฃ ูุฑุงุฏ ูโุฒูู", "๐ ุตุจุฑ ูโฺฉูู ุชุง ูุงุถุญโุชุฑ ุดูุฏ", "๐ป ุณฺฏูุงู ุฑุง ูุงุฏุฏู ูโฺฏุฑู"],
"answer": 0,
"explanations": {
0: "โ ุฏูุจุงู ฺฉุฑุฏู ุตุฏุง ููฺฉู ุงุณุช ุจู ุชุฌูุฒุงุช ุง ฺฉูฺฉ ุจุฑุณุฏ.",
1: "ูุฑุงุฏ ุฒุฏู ุจุงุนุซ ูุฏุฑ ุฑูุชู ุงูุฑฺ ู ุฌูุจ ุญูุงูุงุช ูโุดูุฏ.",
2: "ุตุจุฑ ููฺฉู ุงุณุช ูุฑุตุช ุฑุง ุงุฒ ุจู ุจุจุฑุฏ.",
3: "ูุงุฏุฏู ฺฏุฑูุชู ุณฺฏูุงูุ ุงุฒ ุฏุณุช ุฏุงุฏู ุฑุงู ูุฌุงุช ุงุณุช."
}},

{
"question": "๐ณ [ูุฑุญูู 7] ุบุงุฑ ูพุฏุง ูโฺฉู. ูุงุฑุฏ ูโุดุ",
"options": ["โ ุขุฑูุ ูพูุงูฺฏุงู ุฎูุจู", "ููุ ุฎุทุฑูุงฺฉู", "ุฏุงุฎู ุตุฏุง ูโุฒูู", "ููุท ูุฒุฏฺฉ ูโูููู"],
"answer": 3,
"explanations": {
0: "ูุฑูุฏ ุจุฏูู ุจุฑุฑุณ ุฎุทุฑูุงฺฉ ุงุณุช.",
1: "ูุฑุตุช ูพูุงู ฺฏุฑูุชู ุฑุง ุงุฒ ุฏุณุช ูโุฏู.",
2: "ุตุฏุง ุฒุฏู ูโุชูุงูุฏ ุญูุงูุงุช ุฑุง ุชุญุฑฺฉ ฺฉูุฏ.",
3: "โ ูุฒุฏฺฉ ูุงูุฏู ุงููโุชุฑ ุงุณุช ู ุงูฺฉุงู ุจุฑุฑุณ ุฑุง ูุฑุงูู ูโฺฉูุฏ."
}},

{
"question": "๐ง [ูุฑุญูู 8] ุจุงุฑุงู ุดุฏุฏ ูโุจุงุฑุฏ. ุจูุชุฑู ุงูุชุฎุงุจุ",
"options": ["๐ ุฑุงู ุจูุชู", "โบ ุฒุฑ ุฏุฑุฎุช ุจุงุณุชู", "๐ชต ุณุฑูพูุงู ุจุณุงุฒู", "๐ช ุจูุดูู ู ุตุจุฑ ฺฉูู"],
"answer": 2,
"explanations": {
0: "ุฑุงู ุฑูุชู ุฏุฑ ุจุงุฑุงู ุฎุทุฑ ุงูุชุงุฏู ู ฺฏูโุดุฏู ุฑุง ุงูุฒุงุด ูโุฏูุฏ.",
1: "ุฒุฑ ุฏุฑุฎุช ุฎุทุฑูุงฺฉ ุงุณุช.",
2: "โ ุณุฑูพูุงู ุจุงุนุซ ฺฏุฑูโูุงูุฏู ู ุญูุธ ุงูุฑฺ ูโุดูุฏ.",
3: "ูุดุณุชู ุฏุฑ ูุนุฑุถ ุจุงุฑุงู ุจุงุนุซ ููพูุชุฑู ูโุดูุฏ."
}},

{
"question": "๐ [ูุฑุญูู 9] ูุงุฑฺ ูุงุดูุงุฎุชู ูพุฏุง ูโฺฉู. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ฝ ูโุฎูุฑู", "๐ท ุนฺฉุณ ูโฺฏุฑู", "๐ซ ุฑูุง ูโฺฉูู", "๐ ุจู ูโฺฉูู"],
"answer": 2,
"explanations": {
0: "ุฎูุฑุฏู ูุงุฑฺ ูุงุดูุงุณ ูโุชูุงูุฏ ฺฉุดูุฏู ุจุงุดุฏ.",
1: "ุนฺฉุณ ฺฏุฑูุชู ููุฏ ุงุณุช ุงูุง ููุฑ ูุณุช.",
2: "โ ุฑูุง ฺฉุฑุฏู ุงููโุชุฑู ุชุตูู ุงุณุช.",
3: "ุจู ฺฉุฑุฏู ูุงุฑฺ ูู ูโุชูุงูุฏ ุจุงุนุซ ูุณูููุช ุดูุฏ."
}},

{
"question": "๐ฆด [ูุฑุญูู 10] ุฌุณุฏ ุญูุงู ูโุจู. ฺฉูุงุฑุด ุงุณุชุฎูุงู ุชุงุฒู ุงุณุช. ฺู ูโฺฉูุ",
"options": ["๐ ุจุฑุฑุณ ูโฺฉูู", "๐ซ ุฏูุฑ ูโุดู", "๐ ุนูุงูุชโฺฏุฐุงุฑ ูโฺฉูู", "๐ธ ุนฺฉุณ ูโฺฏุฑู"],
"answer": 1,
"explanations": {
0: "ุจุฑุฑุณ ููฺฉู ุงุณุช ุดูุง ุฑุง ุฏุฑฺฏุฑ ุจู ูุงุดู ฺฉูุฏ.",
1: "โ ุฏูุฑ ุดุฏู ุงุฒ ูุญู ุงุญุชูุงู ููุงุฌูู ุจุง ุดฺฉุงุฑฺ ุฑุง ฺฉู ูโฺฉูุฏ.",
2: "ุนูุงูุชโฺฏุฐุงุฑ ุฒูุงูโุจุฑ ุงุณุช ู ุงุฑุฒุด ูุฏุงุฑุฏ.",
3: "ุนฺฉุณ ฺฏุฑูุชู ฺฉุงุฑ ุจโูุงุฏูโุง ุฏุฑ ุจูุงุณุช."
}},

{
"question": "๐งญ [ูุฑุญูู 11] ูุทุจโููุง ูพุฏุง ูโฺฉูุ ูู ููุดู ูุฏุงุฑ. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐งญ ฺฉูุฑฺฉูุฑุงูู ุจู ุดูุงู ูโุฑู", "๐ ุฏูุจุงู ูุณุฑ ูพุงฺฉูุจ ูโฺฏุฑุฏู", "๐ถ ูุฑ ุณูุช ฺฉู ุฑุงุญุชโุชุฑู ูโุฑู", "๐ ุตุจุฑ ูโฺฉูู"],
"answer": 1,
"explanations": {
0: "ุญุฑฺฉุช ฺฉูุฑฺฉูุฑุงูู ุฏุฑ ุฌูฺฏู ูโุชููู ุจุงุนุซ ฺฏูโุดุฏฺฏ ุจุดุชุฑ ุจุดู.",
1: "โ ุฏูุจุงู ฺฉุฑุฏู ูุณุฑ ูพุงฺฉูุจ ุงุญุชูุงู ุฑุณุฏู ุจู ฺฉูฺฉ ุฑู ุจุงูุง ูโุจุฑู.",
2: "ุฑุงุญุชโุชุฑู ูุณุฑ ููฺฉูู ุจู ูุฑุฏุงุจ ุง ุฎุทุฑ ููุชู ุจุดู.",
3: "ุตุจุฑ ููฺฉูู ูุฑุตุช ูุฌุงุช ุฑู ุงุฒุช ุจฺฏุฑู."
}},

{
"question": "๐ [ูุฑุญูู 12] ุตุฏุง ุฌุบ ุงูุณุงู ูโุดูู. ูุงฺฉูุดุ",
"options": ["๐ ุจู ุณูุช ุตุฏุง", "๐ฃ ุฌูุงุจ ูโุฏ", "๐ซ ูุงุฏุฏู ูโฺฏุฑ", "๐ญ ุจุง ุฏูุช ฺฏูุด ูโุฏ"],
"answer": 3,
"explanations": {
0: "ุญุฑฺฉุช ุณุฑุน ุจุฏูู ุงุทูุงุน ุงุฒ ูุถุนุช ููฺฉูู ุฎุทุฑูุงฺฉ ุจุงุดู.",
1: "ูุฑุงุฏ ุฒุฏู ุชูุฌู ุญูุงูุงุช ุฑู ูู ุฌูุจ ูโฺฉูู.",
2: "ูุงุฏุฏู ฺฏุฑูุชู ููฺฉูู ฺฉูฺฉ ุจู ุงูุณุงู ูุงุฒููุฏ ุฑู ุงุฒ ุจู ุจุจุฑู.",
3: "โ ฺฏูุด ุฏุงุฏู ู ุงุฑุฒุงุจ ุตุฏุง ูุจู ุงุฒ ูุฑ ูุงฺฉูุด ููุดููุฏุงููโุชุฑู."
}},

{
"question": "๐ป [ูุฑุญูู 13] ุฑุงุฏู ูพุฏุง ูโฺฉูุ ูู ุฎุฑุงุจ ุดุฏู. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ ุจุงุทุฑโูุงุดู ุจุฑูโุฏุงุฑ", "๐ ุณุน ูโฺฉู ุชุนูุฑุด ฺฉู", "๐ฆ ุฑูุงุด ูโฺฉู", "๐ก ุจู ุนููุงู ุณฺฏูุงูโุณุงุฒ ุงุณุชูุงุฏู ูโฺฉู"],
"answer": 3,
"explanations": {
0: "ุจุงุทุฑ ููุฏ ูุณุช ูู ุจู ุชููุง ฺฉูฺฉ ุจู ุงุฑุณุงู ฺฉูฺฉ ููโฺฉูู.",
1: "ุชุนูุฑ ุจุฏูู ุงุจุฒุงุฑ ููฺฉู ูุณุช.",
2: "ุฏูุฑ ุงูุฏุงุฎุชู ุงุจุฒุงุฑ ุงูฺฉุชุฑููฺฉ ุงุดุชุจุงูู.",
3: "โ ุงุณุชูุงุฏู ุงุฒ ุขูุชู ู ูุทุนุงุช ุจุฑุง ุณฺฏูุงูโุฏู ููุดููุฏุงููโุณุช."
}},

{
"question": "๐ช [ูุฑุญูู 14] ฺฉ ุชุจุฑ ุฒูฺฏโุฒุฏู ูพุฏุง ูโฺฉู. ุงุณุชูุงุฏูุ",
"options": ["๐ช ุจุงูุงุด ุฏุฑุฎุช ูโุจุฑู", "๐งผ ุชูุฒุด ูโฺฉู", "๐ง ุฏุฑ ุขุจ ูโุดูุฑ", "๐ ุฏูุฑุด ูโุงูุฏุงุฒ"],
"answer": 1,
"explanations": {
0: "ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑ ุฒูฺฏโุฒุฏู ุฎุทุฑ ุขุณุจ ู ุนูููุช ุฏุงุฑู.",
1: "โ ุชูุฒ ฺฉุฑุฏู ุงุจุฒุงุฑ ุงูููุช ุฏุงุฑู ูุจู ุงุณุชูุงุฏู.",
2: "ุขุจ ุจู ุชููุง ุฒูฺฏ ุฑู ุงุฒ ุจู ููโุจุฑู.",
3: "ุงุจุฒุงุฑ ููุฏ ูฺโููุช ูุจุงุฏ ุฏูุฑ ุงูุฏุงุฎุชู ุจุดู."
}},

{
"question": "๐ [ูุฑุญูู 15] ุจุง ูุงุฑ ููุงุฌู ูโุด. ฺโฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ก ุจูุด ุญููู ูโฺฉู", "๐ถ ุจูโุขุฑูู ุฏูุฑ ูโุด", "๐งฑ ุฑูุด ฺุฒ ูโุงูุฏุงุฒ", "๐ท ุนฺฉุณ ูโฺฏุฑ"],
"answer": 1,
"explanations": {
0: "ุญูููุ ูุงุฑ ุฑู ุชุญุฑฺฉ ุจู ูุดโุฒุฏู ูโฺฉูู.",
1: "โ ุฏูุฑ ุดุฏู ุขุฑุงู ฺฉูุชุฑู ุฑุณฺฉ ุฑู ุฏุงุฑู.",
2: "ุญุฑฺฉุช ุณุฑุน ุจุงุนุซ ูุงฺฉูุด ูุงุฑ ูุดู.",
3: "ฺฏุฑูุชู ุนฺฉุณ ุนู ุจโุชูุฌู ุจู ุฎุทุฑ."
}},

{
"question": "๐ง [ูุฑุญูู 16] ุขุจ ูพุฏุง ูโฺฉู ูู ุจู ูโุฏู. ูุงฺฉูุดุ",
"options": ["๐ฐ ูโุฎูุฑ ฺูู ุชุดููโุง", "๐ฅ ูโุฌูุดูู", "๐ฆ ุฑูุง ูโฺฉู", "๐งช ุจู ูโฺฉู ู ูโููุด"],
"answer": 1,
"explanations": {
0: "ููุดุฏู ุขุจ ุขููุฏู ููฺฉูู ุจุงุนุซ ุงุณูุงู ู ูุฑฺฏ ุจุดู.",
1: "โ ุฌูุดููุฏู ุขุจ ุชุง ุญุฏ ุฒุงุฏ ุงูู ุฑู ุงูู ูโฺฉูู.",
2: "ุฏูุฑ ุงูุฏุงุฎุชู ุจุฏูู ุจุฑุฑุณ ุงุดุชุจุงูู.",
3: "ุจู ฺฉุฑุฏู ูุดูู ููโุฏู ฺฉู ุขุจ ุขููุฏู ูุณุช."
}},

{
"question": "๐ฏ [ูุฑุญูู 17] ฺฉุจุฑุชโูุงุชู ุฎุณ ฺฉุฑุฏ. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ ุชู ุขูุชุงุจ ุฎุดฺฉ ูโฺฉู", "๐ฅ ุจุง ุณูฺฏ ุขุชุด ุฏุฑุณุช ูโฺฉู", "๐ฆ ุจโุฎุงู ูโุด", "๐งป ฺูุจ ูุฑุทูุจ ูโุณูุฒูู"],
"answer": 0,
"explanations": {
0: "โ ุฎุดฺฉ ฺฉุฑุฏู ฺฉุจุฑุชโูุง ุดุงุฏ ุจุชููู ุฏูุจุงุฑู ุจูุช ูุฑุตุช ุขุชุด ุจุฏู.",
1: "ุณูฺฏ ุฒุฏู ุจู ฺูุจ ุจุฏูู ุขุชุดโุฒูู ูุคุซุฑ ูุณุช.",
2: "ฺฉุจุฑุช ูููุฒ ูโุชููู ููุฏ ุจุงุดูุ ูุจุงุฏ ุจโุฎุงูุด ุดุฏ.",
3: "ฺูุจ ูุฑุทูุจ ููโุณูุฒู ู ููุท ุฏูุฏ ุงุฌุงุฏ ูโฺฉูู."
}},

{
"question": "๐ฆ [ูุฑุญูู 18] ุฌุนุจู ฺฉูฺฉโูุง ุงููู ุฏุงุฑ. ฺู ฺุฒ ุงูู ูุงุฒููุ",
"options": ["๐ฉน ฺุณุจ ุฒุฎู", "๐ ุขูุชโุจูุชฺฉ", "๐งด ุถุฏุนูููโฺฉููุฏู", "๐ฉบ ุจุงูุฏ"],
"answer": 2,
"explanations": {
0: "ฺุณุจ ุฒุฎู ุจุฏูู ุชูุฒฺฉุฑุฏู ุฒุฎู ูุงุฏู ูุฏุงุฑู.",
1: "ุขูุชโุจูุชฺฉ ุจุงุฏ ุจุง ุงุญุชุงุท ูุตุฑู ุจุดู.",
2: "โ ุงูู ุฒุฎู ุจุงุฏ ุชูุฒ ุจุดู ุชุง ุนูููุช ูฺฉูู.",
3: "ุจุงูุฏ ุจุฑุง ุจุนุฏ ุงุฒ ุชูุฒฺฉุฑุฏู ุฒุฎู ุงุณุชูุงุฏู ูโุดู."
}},

{
"question": "๐ [ูุฑุญูู 19] ุงุฒ ุชูพู ุจููุฏ ููุธุฑูโุง ูุณุน ูโุจู. ฺโฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ ุนูุงูุช ูโุฐุงุฑ", "๐ฆ ุณฺฏูุงู ูโุฏ", "๐ฏ ูพุงู ูโุฑ", "๐ซ ุจโุชูุงูุช ุฑุฏ ูโุด"],
"answer": 1,
"explanations": {
0: "ุนูุงูุชโฺฏุฐุงุฑ ููุฏู ูู ุงูููุช ูุณุช.",
1: "โ ูููุนุช ุจุงูุง ุจูุชุฑู ูุฑุตุช ุจุฑุง ุณฺฏูุงูโุฏุงุฏูู.",
2: "ูพุงู ุฑูุชู ุดุงุฏ ุจุงุนุซ ฺฏู ุดุฏู ุจุดู.",
3: "ุจโุชูุฌู ุจู ฺูู ูููุนุช ุงุดุชุจุงู ุจุฒุฑฺฏู."
}},

{
"question": "๐ฅซ [ูุฑุญูู 20] ฺฉูุณุฑู ุจุงุฒ ฺฉุฑุฏ ุงูุง ุจู ูโุฏู. ูโุฎูุฑุ",
"options": ["๐ท ููุ ูพุฑุช ูโฺฉู", "๐ฝ ฺฉู ุชุณุช ูโฺฉู", "๐ฅ ูโูพุฒ ฺฉู ุจูุด ุจุฑู", "๐ซ ูฺฏู ูโุฏุงุฑ ุจุฑุง ุจุนุฏ"],
"answer": 0,
"explanations": {
0: "โ ฺฉูุณุฑู ูุงุณุฏ ุฎู ุฎุทุฑูุงฺฉูุ ูุจุงุฏ ุฎูุฑุฏู ุจุดู.",
1: "ุญุช ฺฉ ูุงุดู ูู ููฺฉูู ุจุงุนุซ ูุณูููุช ุดุฏุฏ ุจุดู.",
2: "ูพุฎุชู ููู ุจุงฺฉุชุฑโูุง ุฑู ุงุฒ ุจู ููโุจุฑู.",
3: "ูฺฏูโุฏุงุดุชู ุบุฐุง ูุงุณุฏ ุงุดุชุจุงูู."
}},

{
"question": "โ๏ธ [ูุฑุญูู 21] ุจู ุดุงุฎูโุง ุจุฑุฎูุฑุฏ ูโฺฉู ฺฉู ูุดุงููโุง ุฑูุด ุญฺฉ ุดุฏู. ฺโฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ ุจุฑุฑุณ ุฏูู ูโฺฉู", "๐ซ ูุงุฏุฏู ูโฺฏุฑ", "๐ธ ุนฺฉุณ ูโฺฏุฑ", "๐งญ ุฌูุช ุญุฑฺฉุช ุฑู ุนูุถ ูโฺฉู"],
"answer": 0,
"explanations": {
0: "โ ุจุฑุฑุณ ูุดุงููโูุง ููฺฉูู ุงุทูุงุนุงุช ุงุฒ ุฏฺฏุฑ ูุฌุงุชโุงูุชูโูุง ุง ุฎุทุฑ ุจุฏู.",
1: "ูุงุฏุฏู ฺฏุฑูุชู ูุดูููโูุง ุนู ุงุฒ ูุฑุตุช ุขฺฏุงู ูุญุฑูู ูโุด.",
2: "ุนฺฉุณ ุจุฏูู ุชุญูู ฺฉุงุฑุจุฑุฏ ูุฏุงุฑู ุฏุฑ ูุญุธู.",
3: "ุชุบุฑ ูุณุฑ ุจุฏูู ุฏูู ููฺฉูู ุงุดุชุจุงู ุจุงุดู."
}},

{
"question": "๐ฆ [ูุฑุญูู 22] ูพุฑูุฏูโุง ุนุฌุจ ุจุง ุฌุบ ุจููุฏ ุจุงูุง ุณุฑุช ูพุฑูุงุฒ ูโฺฉูู. ฺู ูโฺฉูุ",
"options": ["๐งญ ุฏูุจุงู ูุณุฑุด ูโุฑ", "๐ข ูุฑุงุฏ ูโุฒู", "๐ญ ุงุฒ ุฏูุฑ ูฺฏุงู ูโฺฉู", "๐ถ ุงุฒ ุงูู ููุทูู ุฏูุฑ ูโุด"],
"answer": 2,
"explanations": {
0: "ุฏูุจุงู ฺฉุฑุฏู ุญูุงู ุจุฏูู ูุฏู ููฺฉูู ููุชู ุจู ุฎุทุฑ ุจุดู.",
1: "ูุฑุงุฏ ุฒุฏู ููฺฉูู ุชูุฌู ุดฺฉุงุฑฺโูุง ุฑู ุฌูุจ ฺฉูู.",
2: "โ ูุดุงูุฏู ุงุฒ ุฏูุฑ ุจุงุนุซ ุญูุธ ุงููุช ู ุฌูุนโุขูุฑ ุงุทูุงุนุงุช ูโุดู.",
3: "ุฏูุฑ ุดุฏู ุจุฏูู ุงุฑุฒุงุจ ูููุนุช ฺฏุงู ุจุงุนุซ ุงุฒ ุฏุณุช ุฏุงุฏู ุดุงูุณ ูุฌุงุช ูโุดู."
}},

{
"question": "๐ง [ูุฑุญูู 23] ุดุจ ุฏูุง ุจู ุดุฏุช ูพุงู ูุงุฏ. ูุจุงุณ ุฎุณ ุชูุชู. ฺู ูโฺฉูุ",
"options": ["๐ฅ ุขุชุด ุฏุฑุณุช ูโฺฉู", "๐งฅ ูุจุงุณโุชู ุฏุฑ ูุงุฑ", "๐ ูุนุงูุช ูโฺฉู", "๐ ูโุฎูุงุจ"],
"answer": 0,
"explanations": {
0: "โ ุขุชุด ุจุงุนุซ ฺฏุฑู ุดุฏู ุณุฑุน ู ุฌููฺฏุฑ ุงุฒ ููพูุชุฑู ูโุดู.",
1: "ูุจุงุณ ุฎุณ ุงฺฏุฑ ุฏุฑุขูุฑุฏู ูุดูุ ุจุงุนุซ ุงูุช ุฏูุง ูโุดู.",
2: "ูุนุงูุช ุฏุฑ ุดุจ ุจุงุนุซ ุฎุณุชฺฏ ู ุฑุณฺฉ ุจุดุชุฑู.",
3: "ุฎูุงุจ ุจุง ูุจุงุณ ุฎุณ ุจุณุงุฑ ุฎุทุฑูุงฺฉู."
}},

{
"question": "๐ฏ [ูุฑุญูู 24] ุตุฏุง ุชุฑ ูโุดูู. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ ุจู ุณูุชุด ูโุฑ", "๐ง ูพููุงู ูโุด", "๐ฃ ฺฉูฺฉ ูโุฎูุง", "๐ซ ุจโุชูุงูุช ุฑุฏ ูโุด"],
"answer": 1,
"explanations": {
0: "ูุฒุฏฺฉ ุดุฏู ุจู ุตุฏุง ุชุฑุงูุฏุงุฒ ุฎุทุฑูุงฺฉู.",
1: "โ ูพููุงู ุดุฏู ุงููโุชุฑู ูุงฺฉูุดู.",
2: "ูุฑุงุฏ ุฏุฑ ุดุฑุงุท ูุงุดูุงุฎุชู ุนุงููุงูู ูุณุช.",
3: "ูุงุฏุฏู ฺฏุฑูุชู ุตุฏุง ูโุชููู ุดุงูุณ ูุฌุงุช ุง ุฎุทุฑ ุฑู ุงุฒุช ุจฺฏุฑู."
}},

{
"question": "๐ฆท [ูุฑุญูู 25] ุฏูุฏููโุฏุฑุฏ ุดุฏุฏ ฺฏุฑูุช ู ุฏุงุฑู ูุฏุงุฑ. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ ุงุฒ ฺฏุงู ุงุณุชูุงุฏู ูโฺฉู", "๐ง ุขุจ ุณุฑุฏ ูโุฎูุฑ", "๐ค ุตุจุฑ ูโฺฉู ุชุง ุฎูุจ ุดู", "๐ฅ ฺุฒ ุจุง ุฏูุฏูู ููโุฌู"],
"answer": 0,
"explanations": {
0: "โ ุจุฑุฎ ฺฏุงูุงู ูุซู ูุฎฺฉ ุงุซุฑ ุชุณฺฉู ุฏุงุฑูุฏ.",
1: "ุขุจ ุณุฑุฏ ุฏุฑุฏ ุฑู ุจุดุชุฑ ูโฺฉูู.",
2: "ุตุจุฑ ฺฉุฑุฏู ุจุฏูู ุงูุฏุงู ูุชุฌู ูุฏุงุฑู.",
3: "ูุฌูุฏู ูุคุซุฑู ุงูุง ูููุชู ู ุฏุฑูุงู ูุณุช."
}},

{
"question": "๐ [ูุฑุญูู 26] ุจุงูฺฏุฑุฏ ุงูุฏุงุฏ ุฎู ุฏูุฑ ุฏุฏู ูโุดู. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ฃ ุฏุงุฏ ูโุฒู", "๐ฅ ุขุชุด ุจุฒุฑฺฏ ูโุฒู", "๐ฑ ูพุงู ูโูุฑุณุช", "๐ ุฏุณุช ุชฺฉูู ูโุฏ"],
"answer": 1,
"explanations": {
0: "ูุฑุงุฏ ุจู ฺฏูุด ุฎูุจุงู ููโุฑุณู.",
1: "โ ุฏูุฏ ุบูุธ ุจูุชุฑู ุนูุงูุช ุจุฑุง ุจุงูฺฏุฑุฏู.",
2: "ุฏุฑ ุฌูฺฏู ุณฺฏูุงู ููุจุงู ูุณุช.",
3: "ุฏุณุช ุชฺฉูู ุฏุงุฏู ุฏุฑ ูุงุตูู ุฒุงุฏ ุจโูุงุฏูโุณุช."
}},

{
"question": "๐งต [ูุฑุญูู 27] ุฒุฎู ุนูู ุฏุงุฑ. ฺู ฺุฒ ุงูููุช ุฏุงุฑูุ",
"options": ["๐งผ ุชูุฒ ฺฉุฑุฏู", "๐ฉน ุจุณุชู", "๐งช ุขูุชโุจูุชฺฉ", "๐ง ฺฉููพุฑุณ"],
"answer": 0,
"explanations": {
0: "โ ุถุฏุนููู ูุจู ุงุฒ ูุฑ ฺุฒ ูุงูุน ุนูููุช ูโุดู.",
1: "ุจุณุชู ุฒุฎู ูุจู ุชูุฒ ฺฉุฑุฏู ุจุงุนุซ ุญุจุณ ุขููุฏฺฏ ูโุดู.",
2: "ุขูุชโุจูุชฺฉ ุฏุฑ ุงุซุฑ ูโฺฉูู ู ููุดู ุฏุฑ ุฏุณุชุฑุณ ูุณุช.",
3: "ฺฉููพุฑุณ ุฏุฑุฏ ุฑู ฺฉู ูโฺฉูู ูู ุฏุฑูุงู ูุณุช."
}},

{
"question": "๐ฆ [ูุฑุญูู 28] ฺุฑุงุบ ูููโุงุช ุถุนู ุดุฏู. ุจุงุชุฑ ูุฏุงุฑ. ฺฺฉุงุฑ ูโฺฉูุ",
"options": ["๐ ุงุฒ ููุฑ ูุงู ุงุณุชูุงุฏู ูโฺฉู", "๐ฆ ุฎุงููุดุด ูโฺฉู ุจุฑุง ุจุนุฏ", "๐ฅ ูโุฒู ุจู ุณูฺฏ", "๐ช ุขุชุด ุฏุฑุณุช ูโฺฉู"],
"answer": 1,
"explanations": {
0: "ููุฑ ูุงู ฺฉุงูู ุงูุง ุฏุฑ ุดุจ ฺฉุงูู ูุณุช.",
1: "โ ุฎุงููุด ฺฉุฑุฏู ุจุงุชุฑ ุฑู ุจุฑุง ููุงูุน ุถุฑูุฑ ูฺฏู ูโุฏุงุฑู.",
2: "ุฒุฏู ฺุฑุงุบ ููู ุฎุฑุงุจุด ูโฺฉูู.",
3: "ุขุชุด ุฎูุจู ูู ูุงุฒ ุจู ุฒูุงู ู ุงูุฑฺ ุฏุงุฑู."
}},

{
"question": "๐ [ูุฑุญูู 29] ฺูุฏ ุฑูุฒ ฺฏุฐุดุชู ู ุงูุฏ ูุฌุงุช ฺฉู ุดุฏู. ฺู ูโฺฉูุ",
"options": ["๐ ุชุณูู ูโุด", "๐ ุจุฑูุงููโุฑุฒ ูโฺฉู", "๐ถ ุจู ุฏู ุฌูฺฏู ูโุฒู", "๐ด ููุท ุงุณุชุฑุงุญุช ูโฺฉู"],
"answer": 1,
"explanations": {
0: "ุชุณูู ุดุฏู ุนู ูพุงุงู ุจุงุฒ.",
1: "โ ุงุฏุงูู ุญุงุช ูุงุฒ ุจู ุจุฑูุงูู ู ุงุฑุงุฏู ุฏุงุฑู.",
2: "ุญุฑฺฉุช ุจโุจุฑูุงูู ูโุชููู ฺฉุดูุฏู ุจุงุดู.",
3: "ุงุณุชุฑุงุญุช ูุฏุงูู ุจุงุนุซ ุชุญูู ุงูุฑฺ ูโุดู."
}},

{
"question": "๐ [ูุฑุญูู 30] ุตุจุญ ุฑูุฒ ููุชูุ ุตุฏุง ุงูุฑุงุฏ ูุฒุฏฺฉ ุดูุฏู ูโุดู. ุขุฎุฑู ุงูุชุฎุงุจ ุชูุ",
"options": ["๐ข ุฏุงุฏ ูโุฒู", "๐ก ุนูุงูุช ูโุฏ", "๐ฅ ุฏูุฏ ุงุฌุงุฏ ูโฺฉู", "๐ ุจุง ุชูุงู ูุฑู ุจู ุณูุช ุตุฏุง ูโุฑ"],
"answer": 2,
"explanations": {
0: "ุฏุงุฏ ููฺฉูู ุดูุฏู ูุดู.",
1: "ุนูุงูุช ุฏุงุฏู ููุซุฑู ุงูุง ููฺฉูู ุฏุฏู ูุดู.",
2: "โ ุฏูุฏ ููโุชุฑู ุนูุงูุช ุฏุฏุงุฑู.",
3: "ุฏูุฏู ุจุฏูู ุงุฑุฒุงุจ ููฺฉูู ุจู ุฎุทุฑ ุจุฑุณ."
}},

]


        
   
    with open(QUESTIONS_FILE, "w") as f:
        json.dump(sample_questions, f)

with open(QUESTIONS_FILE) as f:
    QUESTIONS = json.load(f)

def save_users(users):
    with open(DATA_FILE, "w") as f:
        json.dump(users, f)

def load_users():
    with open(DATA_FILE) as f:
        return json.load(f)

def check_name(m):
    users = load_users()
    return str(m.chat.id) in users and users[str(m.chat.id)]["name"] != ""

def check_membership(user_id):
    try:
        status = bot.get_chat_member(CHANNEL_USERNAME, user_id).status
        return status in ['member', 'creator', 'administrator']
    except:
        return False

def main_menu():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("๐ฎ ุดุฑูุน ุจุงุฒ", "๐ ุจุฑุชุฑู ูุง")
    markup.add("๐ ูุฑูุดฺฏุงู", "๐งโ๐คโ๐ง ุฏุนูุช ุฏูุณุชุงู")
    markup.add("๐ค ูพุฑููุงู", "๐ ูพุงุฏุงุด ุฑูุฒุงูู")
    return markup

@bot.message_handler(commands=['start'])
def start(m):
    users = load_users()

    # ุนุถูุช ุงุฌุจุงุฑ
    if not check_membership(m.chat.id):
        markup = types.InlineKeyboardMarkup()
        btn = types.InlineKeyboardButton("๐ข ุนุถูุช ุฏุฑ ฺฉุงูุงู", url=f"https://t.me/{CHANNEL_USERNAME[1:]}")
        markup.add(btn)
        bot.send_message(m.chat.id, "๐ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุงุจุชุฏุง ุฏุฑ ฺฉุงูุงู ุนุถู ุดูุฏ ู ุณูพุณ ุฏูุจุงุฑู /start ุฑุง ุจูุฑุณุชุฏ:", reply_markup=markup)
        return

    # ุงฺฏู ฺฉุงุฑุจุฑ ุฌุฏุฏ ุจุงุดู
    if str(m.chat.id) not in users:
        users[str(m.chat.id)] = {
            "name": "",
            "coin": 0,
            "life": 3,
            "score": 0,
            "step": 0,
            "last_bonus": "0",
            "ref": 0
        }
        save_users(users)

    # โ ุจุฑุฑุณ ุงูฺฉู ุงุณู ูุงุฑุฏ ฺฉุฑุฏู ุง ูู
    if users[str(m.chat.id)]["name"] == "":
        bot.send_message(m.chat.id, "๐ ูุทูุงู ูุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")
        bot.register_next_step_handler(m, get_name)
    else:
        bot.send_message(m.chat.id, "๐ ุฎูุด ุขูุฏุฏ!", reply_markup=main_menu())
        
def get_name(m):
    if m.text.startswith("/"):
        bot.send_message(m.chat.id, "โ๏ธูุงู ููโุชูุงูุฏ ุจุง / ุดุฑูุน ุดูุฏ. ูุทูุงู ููุท ูุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")
        bot.register_next_step_handler(m, get_name)
        return
    users = load_users()
    users[str(m.chat.id)]["name"] = m.text
    save_users(users)
    bot.send_message(m.chat.id, f"โ ุจู ุจุงุฒ ุจูุง ุฎูุด ุขูุฏ {m.text}!", reply_markup=main_menu())

# ๐ฎ ุจุงุฒ
@bot.message_handler(func=lambda m: m.text == "๐ฎ ุดุฑูุน ุจุงุฒ")
def start_game(m):
    users = load_users()
    u = users[str(m.chat.id)]
    if u["life"] <= 0:
        bot.send_message(m.chat.id, "โ ุดูุง ุฌุงู ูุฏุงุฑุฏ! ูุทูุงู ุงุฒ ูุฑูุดฺฏุงู ุฌุงู ุจุฎุฑุฏ.")
        return
    if u["step"] >= len(QUESTIONS):
        bot.send_message(m.chat.id, "๐ ุดูุง ุชูุงู ูุฑุงุญู ุฑุง ฺฏุฐุฑุงูุฏูโุงุฏ!")
        return
    q = QUESTIONS[u["step"]]
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    for i, opt in enumerate(q["options"]):
        markup.add(f"{i+1} - {opt}")
    markup.add("๐ ุจุงุฒฺฏุดุช ุจู ููู")
    bot.send_message(m.chat.id, q["question"], reply_markup=markup)

@bot.message_handler(func=lambda m: m.text.startswith(tuple(str(i+1) for i in range(4))))
def answer_question(m):
    users = load_users()
    u = users[str(m.chat.id)]
    if u["step"] >= len(QUESTIONS):
        return
    q = QUESTIONS[u["step"]]
    selected = int(m.text.split("-")[0].strip()) - 1
    if selected == q["answer"]:
        u["coin"] += 10
        u["score"] += 20
        bot.send_message(m.chat.id, "โ ุฏุฑุณุช ุจูุฏ! ฑฐ ุณฺฉู ู ฒฐ ุงูุชุงุฒ ฺฏุฑูุช.")
    else:
        u["score"] += 5
        bot.send_message(m.chat.id, f"โ ุงุดุชุจุงู ุจูุฏ. ุฏูู: {q['explanation']}")
    u["step"] += 1
    save_users(users)
    start_game(m)

@bot.message_handler(func=lambda m: m.text == "๐ ุจุงุฒฺฏุดุช ุจู ููู")
def back_to_menu(m):
    bot.send_message(m.chat.id, "โฉ๏ธ ุจุงุฒฺฏุดุช ุจู ููู", reply_markup=main_menu())

# ๐ ูุฑูุดฺฏุงู - ููู
@bot.message_handler(func=lambda m: m.text == "๐ ูุฑูุดฺฏุงู")
def shop(m):
    msg = f"""๐ ูุฑูุดฺฏุงู:

๐ฐ ููุช ฑฐฐ ุณฺฉู = ด ุชุฑูู  
๐ณ ุขุฏุฑุณ ุชุฑูู: `{TRON_ADDRESS}`

โ ูพุณ ุงุฒ ูพุฑุฏุงุฎุชุ ููู ูพุงู ุฑุง ุฑูพูุง ู ูุด ุฑุง ุงุฑุณุงู ฺฉูุฏ (ุนฺฉุณ ุง ูุชู).


๐ ููฺูู ูโุชูุงูุฏ ุจุง ฑฐฐ ุณฺฉูุ ฑ โค๏ธ ุฌุงู ุจุฎุฑุฏ:
ุจุฑุง ุฎุฑุฏ ุฌุงูุ ฺฏุฒูู ุฒุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:
"""
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    markup.add("๐งก ุฎุฑุฏ ุฌุงู (ฑฐฐ ุณฺฉู)", "๐ ุจุงุฒฺฏุดุช ุจู ููู")
    bot.send_message(m.chat.id, msg, reply_markup=markup, parse_mode="Markdown")

# โค๏ธ ุฎุฑุฏ ุฌุงู ุจุง ฑฐฐ ุณฺฉู
@bot.message_handler(func=lambda m: m.text == "๐งก ุฎุฑุฏ ุฌุงู (ฑฐฐ ุณฺฉู)")
def buy_life(m):
    users = load_users()
    u = users[str(m.chat.id)]
    if u["coin"] >= 100:
        u["coin"] -= 100
        u["life"] += 1
        save_users(users)
        bot.send_message(m.chat.id, "๐งก ฺฉ ุฌุงู ุจุง ููููุช ุฎุฑุฏุงุฑ ุดุฏ! โค๏ธ")
    else:
        bot.send_message(m.chat.id, "โ ุดูุง ุณฺฉู ฺฉุงู ุจุฑุง ุฎุฑุฏ ุฌุงู ูุฏุงุฑุฏ.")

# ๐ณ ุงุฑุณุงู ูุด ูพุฑุฏุงุฎุช (ุฏุฑุฎูุงุณุช)
@bot.message_handler(content_types=['photo'])
def handle_photo_payment(m):
    # ุจุฑุฑุณ ฺฉู ฺฉู ุขุง ุงู ุนฺฉุณ ูพุงุณุฎ ุจู ูพุงู ุฏุฑุฎูุงุณุช ูุด ุงุณุช
    if m.reply_to_message and "ูุด" in m.reply_to_message.text and m.text != "๐ณ ุงุฑุณุงู ูุด ูพุฑุฏุงุฎุช":
        file_id = m.photo[-1].file_id
        caption = f"๐ฅ ูุด ูพุฑุฏุงุฎุช ุชุตูุฑ ุงุฒ {m.from_user.first_name}"
        bot.send_photo(ADMIN_ID, file_id, caption=caption, reply_markup=payment_markup(m.chat.id))
    else:
        bot.send_message(m.chat.id, "๐ธ ูุทูุงู ูุด ูพุฑุฏุงุฎุช ุฑุง ุจู ุตูุฑุช *ุนฺฉุณ* ุง *ูุชู* ุงุฑุณุงู ฺฉู:", reply_markup=types.ForceReply(selective=True), parse_mode="Markdown")
# ๐ค ุฏุฑุงูุช ูุด ูพุฑุฏุงุฎุช ู ุงุฑุณุงู ุจุฑุง ุงุฏูู
@bot.message_handler(func=lambda m: m.reply_to_message and "ูุด" in m.reply_to_message.text and m.text != "๐ณ ุงุฑุณุงู ูุด ูพุฑุฏุงุฎุช")
def handle_payment(m):
    msg = f"๐ฅ ูุด ูพุฑุฏุงุฎุช ุฌุฏุฏ ุงุฒ {m.from_user.first_name}:\n\n"
    if m.content_type == "photo":
        file_id = m.photo[-1].file_id
        bot.send_photo(ADMIN_ID, file_id, caption=msg + "(ูุด ุชุตูุฑ)", reply_markup=payment_markup(m.chat.id))
    else:
        bot.send_message(ADMIN_ID, msg + m.text, reply_markup=payment_markup(m.chat.id))

# โ ุฏฺฉููโูุง ุชุงุฏ / ุฑุฏ ุจุฑุง ุงุฏูู
def payment_markup(user_id):
    markup = types.InlineKeyboardMarkup()
    markup.add(types.InlineKeyboardButton("โ ุชุงุฏ", callback_data=f"approve_{user_id}"))
    markup.add(types.InlineKeyboardButton("โ ุฑุฏ", callback_data=f"reject_{user_id}"))
    return markup

# โ ุชุงุฏ ูพุฑุฏุงุฎุช ุชูุณุท ุงุฏูู
@bot.callback_query_handler(func=lambda call: call.data.startswith("approve_"))
def approve_payment(call):
    user_id = call.data.split("_")[1]
    users = load_users()
    users[user_id]["coin"] += 100
    save_users(users)
    bot.send_message(int(user_id), "โ ูพุฑุฏุงุฎุช ุดูุง ุชุงุฏ ุดุฏ! ฑฐฐ ุณฺฉู ุจู ุญุณุงุจ ุดูุง ุงุถุงูู ุดุฏ.")
    bot.answer_callback_query(call.id, "ูพุฑุฏุงุฎุช ุชุงุฏ ุดุฏ.")

# โ ุฑุฏ ูพุฑุฏุงุฎุช ุชูุณุท ุงุฏูู ุจุง ูพุงู ุฏููโุชุฑ
@bot.callback_query_handler(func=lambda call: call.data.startswith("reject_"))
def reject_payment(call):
    user_id = call.data.split("_")[1]
    bot.send_message(int(user_id), "โ ุฑุณุฏ ูพุฑุฏุงุฎุช ุดูุง ุชูุณุท ุงุฏูู ุฑุฏ ุดุฏ.\nูุทูุงู ุจุฑุฑุณ ู ุฏุฑ ุตูุฑุช ูุงุฒุ ูุฌุฏุฏุงู ุงุฑุณุงู ฺฉูุฏ.")
    bot.answer_callback_query(call.id, "ุฑุฏ ุดุฏ.")

# ๐ค ูพุฑููุงู
@bot.message_handler(func=lambda m: m.text == "๐ค ูพุฑููุงู")
def profile(m):
    users = load_users()
    u = users[str(m.chat.id)]
    msg = f"""๐ค ูุงู: {u['name']}
โค๏ธ ุฌุงู: {u['life']}
๐ฐ ุณฺฉู: {u['coin']}
โญ๏ธ ุงูุชุงุฒ: {u['score']}"""
    bot.send_message(m.chat.id, msg)

# ๐ ูพุงุฏุงุด ุฑูุฒุงูู
@bot.message_handler(func=lambda m: m.text == "๐ ูพุงุฏุงุด ุฑูุฒุงูู")
def daily_bonus(m):
    users = load_users()
    u = users[str(m.chat.id)]
    last = datetime.datetime.strptime(u["last_bonus"], "%Y-%m-%d") if u["last_bonus"] != "0" else datetime.datetime.min
    now = datetime.datetime.now()
    if (now - last).days >= 1:
        u["coin"] += 10
        u["last_bonus"] = now.strftime("%Y-%m-%d")
        save_users(users)
        bot.send_message(m.chat.id, "๐ ฑฐ ุณฺฉู ูพุงุฏุงุด ฺฏุฑูุช!")
    else:
        bot.send_message(m.chat.id, "โณ ูพุงุฏุงุด ุฑูุฒุงููโุงุช ุฑู ูุจูุง ฺฏุฑูุช. ูุฑุฏุง ุจุง!")

# ๐งโ๐คโ๐ง ุฏุนูุช
@bot.message_handler(func=lambda m: m.text == "๐งโ๐คโ๐ง ุฏุนูุช ุฏูุณุชุงู")
def invite(m):
    link = f"https://t.me/{bot.get_me().username}?start={m.chat.id}"
    bot.send_message(m.chat.id, f"๐จ ููฺฉ ุฏุนูุช ุดูุง:\n{link}\nูุฑ ุฏุนูุช = ตฐ ุณฺฉู")

# ๐๏ธ ุจุฑุชุฑูโูุง
@bot.message_handler(func=lambda m: m.text == "๐ ุจุฑุชุฑู ูุง")
def top_players(m):
    users = load_users()
    sorted_users = sorted(users.items(), key=lambda x: x[1]["score"], reverse=True)
    text = "๐ ฑฐ ุจุงุฒฺฉู ุจุฑุชุฑ:\n"
    for i, (uid, u) in enumerate(sorted_users[:10]):
        text += f"{i+1}. {u['name']} - {u['score']} ุงูุชุงุฒ\n"
    bot.send_message(m.chat.id, text)

# ๐ Flask ุจุฑุง ุฏูพูู ุฏุฑ Render
@app.route(f"/{API_TOKEN}", methods=["POST"])
def webhook():
    bot.process_new_updates([telebot.types.Update.de_json(request.stream.read().decode("utf-8"))])
    return "OK"

@app.route("/", methods=["GET"])
def index():
    return "ุจุงุช ูุนุงู ุงุณุช"

def run():
    app.run(host="0.0.0.0", port=int(os.environ.get("PORT", 5000)))

def set_webhook():
    bot.remove_webhook()
    bot.set_webhook(url=f"https://bagha-2qv0.onrender.com/{API_TOKEN}")  # ๐ ุขุฏุฑุณ ุฏูู Render

@bot.message_handler(func=lambda m: True)
def block_if_no_name(m):
    if not check_name(m):
        if m.text != "/start":
            bot.send_message(m.chat.id, "โ๏ธ ูุทูุงู ุงุจุชุฏุง ูุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ. /start")
            
if __name__ == "__main__":
    Thread(target=run).start()
